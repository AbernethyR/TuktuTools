<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating caribou calving dates and locations using the TuktuTools Package • TuktuTools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating caribou calving dates and locations using the TuktuTools Package">
<meta property="og:description" content="TuktuTools">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TuktuTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/estimating_parturition.html">Estimating caribou calving dates and locations using the TuktuTools Package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating caribou calving dates and locations
using the TuktuTools Package</h1>
                        <h4 data-toc-skip class="author">Ophélie Couriot
and Eliezer Gurarie</h4>
            
            <h4 data-toc-skip class="date">12/14/2022</h4>
      
      
      <div class="hidden name"><code>estimating_parturition.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document provides steps to estimate calving (i.e., parturition)
status, timing and location, for female barren-ground caribou
(<em>Rangifer tarandus spp.</em>), by analyzing their movement patterns
using functions from the <code>TuktuTools</code> package.</p>
<p>This tool is a refinement of the the “individual-based method” (IBM)
developed by DeMars et al (2013) to infer calving status. This method
assumes that a female’s movement rate drops rapidly when she calves, and
that displacements remain low for several days or weeks if the calf
survives, since neonates are not able to move as quickly as adults.
Calving events are identifiable by a sudden and marked change – or break
point – in a female’s mean step length (i.e. the distance between two
successive relocations). Conversely, if the female loses her calf during
the neonatal period, a second break point would occur in the female
movement pattern, since the female would recover her pre-calving
movement rate abruptly. The method also assumes that non-calving females
maintian a constant mean movement rate throughout the entire calving
period.</p>
<p>The DeMars method assumes a regularly sampled time series of
observations, since the analysis is performed on step lengths. We adapt
the method to account for variability in sample schedules and missing
data by performing analyses on movement <em>rates</em> (i.e. the
distance traveled divided by the interval between observations) instead
of on step length. More details on this method can be found in Couriot
et al. (<em>in press</em>), and users are encouraged to read the paper
for a deeper understanding of the methodology.</p>
</div>
<div class="section level2">
<h2 id="tuktutools">TuktuTools<a class="anchor" aria-label="anchor" href="#tuktutools"></a>
</h2>
<p>This <strong>preliminary beta version</strong> of the
<code>TuktuTools</code> package contains a selection of tools to:</p>
<ul>
<li>Clean and process movement data</li>
<li>Visualize movement data</li>
<li>Analyze spatial patterns
<ul>
<li>Estimate individual movement rate</li>
<li>Calculate euclidean distance between pairs of individuals</li>
<li>Estimate ranges of an individual or all individuals during a given
period using two different methods (LoCoH or KUD)</li>
<li>Discriminate between parturient and non parturient individuals and
identify parturition timing and location</li>
</ul>
</li>
</ul>
<p>In this document, we focus on the <code>estimateCalving</code>
function, which estimates calving status, timing and location, using an
individual based method. We provide the required steps to estimate
calving, from data processing and cleaning to identifying calving timing
and location. In order to provide concrete examples, the package
includes movement data from four females of barren-ground caribou,
provided by the Government of the Northwest Territories under agreement
<em>8515-05 DR #607</em>.</p>
</div>
<div class="section level2">
<h2 id="estimate-calving">Estimate calving<a class="anchor" aria-label="anchor" href="#estimate-calving"></a>
</h2>
<p>The package, currently, can be installed from GitHub and loaded
via:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"https://github.com/ocouriot/TuktuTools"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">TuktuTools</span><span class="op">)</span></span></code></pre></div>
<p>The example data are loaded as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">caribou</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">caribou</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       ID sex                Time Year       Lon      Lat         x       y</span></span>
<span><span class="co">## 1 Dancer   f 2002-04-01 00:00:00 2002 -133.8427 62.77028 -51589.97 7006600</span></span>
<span><span class="co">## 2 Dancer   f 2002-04-01 08:00:00 2002 -133.8394 62.76716 -51480.43 7006228</span></span>
<span><span class="co">## 3 Dancer   f 2002-04-01 16:00:00 2002 -133.8453 62.77767 -51584.51 7007437</span></span>
<span><span class="co">## 4 Dancer   f 2002-04-02 00:00:00 2002 -133.8643 62.80010 -52121.93 7010074</span></span>
<span><span class="co">## 5 Dancer   f 2002-04-02 08:00:00 2002 -133.8621 62.79918 -52024.50 7009953</span></span>
<span><span class="co">## 6 Dancer   f 2002-04-02 16:00:00 2002 -133.8625 62.80007 -52030.49 7010055</span></span></code></pre>
<p>Note that the data frame contains a Time column (as POSIX) and ID
column, as well as coordinates (Longitude - Latitude) and projected
coordinates (x, y).</p>
<div class="section level3">
<h3 id="clean-data">Clean data<a class="anchor" aria-label="anchor" href="#clean-data"></a>
</h3>
<p>The GPS devices are configured to relocate daily, every 8-hours, or
hourly for some individuals (e.g. 0:00 am, 8:00 am or 4:00 pm). However,
it appears that sometimes the GPS devices relocate at 1 or 2 minute
intervals not fitting with the hourly schedule. In addition, it is
biologically impossible for an animal to move several kilometers in one
minute. Thus, the relocations with a time interval in the order of
minutes are more prone to be ‘outliers’.</p>
<p>The <code>removeOutliers</code> function in this package allows users
to clean data prior to analyses. The function flags relocations that are
not biologically probable, using the following rules:</p>
<ul>
<li>if speed between the fixes is higher than 50 km per hour</li>
<li>if time interval between fixes is less than 2 minutes</li>
<li>if speed is higher than 20 km per hour and the time interval is less
than 10 minutes</li>
</ul>
<div class="section level4">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/removeOutliers.html">removeOutliers</a></span><span class="op">(</span><span class="va">df</span>, steps <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h4>
<p><code>df</code> a data frame containing columns: ID - individual
identifier, x and y coordinates (in a metric system), DateTime - date
and time vector (of class POSIXct)</p>
<p><code>steps</code> if specified, the number of cleaning steps to be
performed (default is 10)</p>
</div>
<div class="section level4">
<h4 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a>
</h4>
<p>The function adds a column “outlier”. If TRUE, it means that the
location has been identified as an outlier.</p>
</div>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">caribou</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove potential outliers and keep only females</span></span>
<span><span class="va">caribou.cleaned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/removeOutliers.html">removeOutliers</a></span><span class="op">(</span><span class="va">caribou</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="op">!</span><span class="va">outlier</span> <span class="op">&amp;</span> <span class="va">sex</span> <span class="op">==</span> <span class="st">"f"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Cleaning Step 1</span></span>
<span><span class="co">## Number of 'outliers' detected: 4</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="focus-on-the-calving-period">Focus on the calving period<a class="anchor" aria-label="anchor" href="#focus-on-the-calving-period"></a>
</h3>
<p>After removing potential outliers, we censored and trimmed our data
to focus on the calving period, to avoid detecting behaviors other than
calving. The calving period has been described to occur between May 19
and July 07 for barren-ground caribou (Cameron et al. 2018). The
convenient function <code>prepData</code> allows trimming the timeseries
to a given period, guaranteeing a minimum number of location fixes a
day, and removing individuals with gaps in the data greater than a
threshold.</p>
<div class="section level4">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prepData.html">prepData</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">start</span>, <span class="va">end</span>, <span class="va">nfixes</span>, <span class="va">dayloss</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a>
</h4>
<p><code>df</code> a data frame containing columns: ID_Year - individual
identifier per year, x and y coordinates (in a metric system), DateTime
- date and time vector (of class POSIXct)</p>
<p><code>start</code>,<code>end</code> period of interest start and end
dates, formated as character strings in the form “mm-dd” (e.g. “05-19”
and “07-07” for the parturition analysis)</p>
<p><code>nfixes</code> individuals with fewer than nfixes observations
per day over the period of of interest are removed</p>
<p><code>dayloss</code> individuals with this meany consecutive days
with missing locations are removed.</p>
</div>
<div class="section level4">
<h4 id="value-1">Value<a class="anchor" aria-label="anchor" href="#value-1"></a>
</h4>
<p>A filtered and processed data frame containing movement data for the
desired period.</p>
</div>
<div class="section level4">
<h4 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<p>We focused our analysis on the period between May 19 to July 7, with
at least 1 fix per day, and no more that 3 consecutive days of missing
data.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caribou.prepped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepData.html">prepData</a></span><span class="op">(</span><span class="va">caribou.cleaned</span>, </span>
<span>                            start <span class="op">=</span> <span class="st">"05-19"</span>, end <span class="op">=</span> <span class="st">"07-07"</span>, </span>
<span>                            nfixes <span class="op">=</span> <span class="fl">1</span>, dayloss <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Period clipped to 05-19 - 07-07</span></span>
<span><span class="co">## Number of excluded individuals-years: 2</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="get-movement-rate">Get movement rate<a class="anchor" aria-label="anchor" href="#get-movement-rate"></a>
</h3>
<p>After we processed, cleaned and filtered movement data, we can
analyze movement patterns and estimate calving (i.e. parturition)
status, date, location and calf death date and location, if any.</p>
<p>As we adapted the method developed by DeMars et al. (2013), by
analyzing movement rate instead of step length. We first calculate the
movement rate between subsequent relocation for each individual and each
year using the <code>getSpeed</code> function.</p>
<div class="section level4">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getSpeed.html">getSpeed</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a>
</h4>
<p><code>df</code> a data frame containing columns: ID - individual
identifier, x and y coordinates (in a metric system), Time - date and
time vector (of class POSIXct)</p>
</div>
<div class="section level4">
<h4 id="value-2">Value<a class="anchor" aria-label="anchor" href="#value-2"></a>
</h4>
<p>The function adds the following columns to the dataframe: *
<code>speed</code> movement rate between subsequent locations (in meters
per hour) * <code>sl</code> step length between subsequent locations *
<code>dhours</code> an index of the cumulative time (in hours) from the
first to the nth relocation * <code>dt</code> time lag between
subsequent relocation (in hours).</p>
</div>
<div class="section level4">
<h4 id="example-2">Example<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h4>
<p>To obtain the movement rates for the 4 barren-ground caribou
females:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">caribou.mr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getSpeed.html">getSpeed</a></span><span class="op">(</span><span class="va">caribou.prepped</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">caribou.mr</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       ID sex                Time Year       Lon      Lat        x       y</span></span>
<span><span class="co">## 1 Dancer   f 2002-05-19 00:00:00 2002 -130.6295 64.86413 139075.4 7215110</span></span>
<span><span class="co">## 2 Dancer   f 2002-05-19 08:00:00 2002 -130.6010 64.91193 141061.6 7220245</span></span>
<span><span class="co">## 3 Dancer   f 2002-05-19 16:00:00 2002 -130.5404 65.03517 145551.0 7233559</span></span>
<span><span class="co">## 4 Dancer   f 2002-05-20 00:00:00 2002 -130.4893 65.12021 149065.5 7242700</span></span>
<span><span class="co">## 5 Dancer   f 2002-05-20 08:00:00 2002 -130.4349 65.17452 152319.3 7248417</span></span>
<span><span class="co">## 6 Dancer   f 2002-05-20 16:00:00 2002 -130.3993 65.22834 154681.2 7254187</span></span>
<span><span class="co">##   outlier               z dt        sl dhours     speed</span></span>
<span><span class="co">## 1   FALSE 139075+7215110i NA        NA      0        NA</span></span>
<span><span class="co">## 2   FALSE 141062+7220245i  8  5505.728      8  688.2160</span></span>
<span><span class="co">## 3   FALSE 145551+7233559i  8 14050.469     16 1756.3086</span></span>
<span><span class="co">## 4   FALSE 149066+7242700i  8  9792.617     24 1224.0772</span></span>
<span><span class="co">## 5   FALSE 152319+7248417i  8  6578.743     32  822.3429</span></span>
<span><span class="co">## 6   FALSE 154681+7254187i  8  6234.093     40  779.2616</span></span></code></pre>
<p>The displacements, intervals and speeds all correspond to the step
moving towards a given location, hence the <code>NA</code> value for the
first of the respective rows.</p>
</div>
</div>
<div class="section level3">
<h3 id="estimate-calving-status-and-timing">Estimate calving status and timing<a class="anchor" aria-label="anchor" href="#estimate-calving-status-and-timing"></a>
</h3>
<p>We can now estimate calving status, calving date, and calf death
date, if any, using the <code>estimateCalving</code> function. This
function determines calving status of a female (no calf, with a calf or
lost her calf), calving date and location, and the calf death date and
location.</p>
<p>As stated previously, we adapted the individual based method
developed by Demars et al. (2013) with the main change beting that we
model movement <em>rates</em> (i.e. speeds) rather than step lengths.
Thus, all models assume that speed follows a Gamma distribution and
differ in two parameters: shape and scale.</p>
<p>For the model representing:</p>
<ol style="list-style-type: decimal">
<li>females that do not calve: the mean movement rate remains constant
through the entire calving period;</li>
<li>females that had a calf who survived at least 4 weeks after birth:
the mean movement rate is constant before calving, then abruptly drops
for calving, creating a break point. After calving, the mean movement
rate increases progressively following: <span class="math inline">\((shape_{calving} * (\frac{\overline{shape} -
shape_{calving}}{k}) * time) * (scale_{calving} *
(\frac{\overline{scale} - scale_{calving}}{k}) * time)\)</span> where
<em>k</em> is the number of days required for the calf to achieve adult
movement rates.</li>
<li>females that lose calves: there is an abrupt change in the slope of
the post-calving increase, creating a second break point after which the
mean speed immediately recovers its pre-calving value.</li>
</ol>
<p>The models therefore differ in their number of parameters to
estimate: the no calf model has two – shape and scale; the calf model
has five – shape and scale before calving, scale at calving, k, and
calving date; and the calf death model has six – shape and scale before
calving, scale at calving, k, and calving and calf death dates. We used
Akaike’s Information Criterion (AIC) model selection and identified the
top performing model with the lowest AIC value.</p>
<p>In practice, separating the calf survived vs. calf died models can be
challenging,</p>
<div class="section level4">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/estimateCalving.html">estimateCalving</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">int</span>, <span class="va">kcons</span>, models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"calfonly"</span><span class="op">)</span>, PlotIt <span class="op">=</span> <span class="cn">FALSE</span>, saveplot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a>
</h4>
<p><code>df</code> a dataframe containing the movement rate between
subsequent relocation of individuals, as obtained using ‘getSpeed’. See
?get.speed for more information on the Data requirements</p>
<p><code>int</code> integer value indicating the minimum number of days
between the beginning of the time series and the first BP (calf birth),
the last BP (calf death) and the end of the time series, and between the
two BPs. The main reason for this constraint is that a minimum number of
data points are required in each section of the time-series to be able
to estimate model parameters. We recommend 9 relocations (e.g. 3 days at
3 locations / day).</p>
<p><code>kcons</code> constraints on the recovery parameter <em>k</em>,
as a vector of the minimum and maximum time it takes the female to
recover normal movement rate (in days).</p>
<p><code>models</code> either <code>full</code> to fit all three models
(i.e., no calf, calf and calf death models), or <code>calfonly</code> to
fit only the no calf and calf models</p>
<p><code>drawplot</code> if TRUE the function will draw a plot of the
movement rate against date with the prediction line of the best model
selected (by ‘AIC’), among no-calf, calf, calf death based on the actual
speed of the female in function of the date</p>
<p><code>saveplot</code> if TRUE, the plot of the best model will be
saved (as ggplot objects).</p>
</div>
<div class="section level4">
<h4 id="value-3">Value<a class="anchor" aria-label="anchor" href="#value-3"></a>
</h4>
<p>The function returns a list of 3 data frames: <code>coeffs</code>
containing the best model for each female, selected based on AIC, the
AIC of the 3 models (i.e. no calf model, calf model and calf death
model) and the negative likelihood of each model. <code>Par</code>
containing the estimated parameters of all the models (0: no calf, 1:
calf, 2: calf death) <code>results</code> containing the best model, for
each female, based on AIC, the calving timing and location (if the calf
model is the best model), and the mortality timing and location of the
calf (if the calf death is the best model).</p>
</div>
<div class="section level4">
<h4 id="application">Application<a class="anchor" aria-label="anchor" href="#application"></a>
</h4>
<p>Note, the function will analyze all of the caribou separately as
below. At the bottom of this vignette, we produce the complete compacted
code (just 5 lines) to run the entire analysis.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Will generate a sample of two different individuals each time</span></span>
<span><span class="va">part</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateCalving.html">estimateCalving</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">caribou.mr</span>, int<span class="op">=</span><span class="fl">3</span>, kcons<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">21</span><span class="op">)</span>, </span>
<span>                        models <span class="op">=</span> <span class="st">"calfonly"</span>, drawplot<span class="op">=</span><span class="cn">TRUE</span>, saveplot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Dancer_2002"</span></span></code></pre>
<p><img src="estimating_parturition_files/figure-html/estimateParturitions-1.png" width="768"></p>
<pre><code><span><span class="co">## [1] "Dancer_2003"</span></span></code></pre>
<p><img src="estimating_parturition_files/figure-html/estimateParturitions-2.png" width="768"></p>
<pre><code><span><span class="co">## [1] "Dancer_2004"</span></span></code></pre>
<p><img src="estimating_parturition_files/figure-html/estimateParturitions-3.png" width="768"></p>
<pre><code><span><span class="co">## [1] "Prancer_2014"</span></span></code></pre>
<p><img src="estimating_parturition_files/figure-html/estimateParturitions-4.png" width="768"></p>
<pre><code><span><span class="co">## [1] "Prancer_2015"</span></span></code></pre>
<p><img src="estimating_parturition_files/figure-html/estimateParturitions-5.png" width="768"></p>
<pre><code><span><span class="co">## [1] "Prancer_2016"</span></span></code></pre>
<p><img src="estimating_parturition_files/figure-html/estimateParturitions-6.png" width="768"></p>
<pre><code><span><span class="co">## [1] "Vixen_2007"</span></span></code></pre>
<p><img src="estimating_parturition_files/figure-html/estimateParturitions-7.png" width="768"></p>
<pre><code><span><span class="co">## [1] "Vixen_2008"</span></span></code></pre>
<p><img src="estimating_parturition_files/figure-html/estimateParturitions-8.png" width="768"></p>
<pre><code><span><span class="co">## [1] "Vixen_2009"</span></span></code></pre>
<p><img src="estimating_parturition_files/figure-html/estimateParturitions-9.png" width="768"></p>
<pre><code><span><span class="co">## [1] "Comet_2006"</span></span></code></pre>
<p><img src="estimating_parturition_files/figure-html/estimateParturitions-10.png" width="768"></p>
<pre><code><span><span class="co">## [1] "Comet_2007"</span></span></code></pre>
<p><img src="estimating_parturition_files/figure-html/estimateParturitions-11.png" width="768"></p>
<p>The object <em><code>part</code></em> is a list of 3 data frames
which show the estimates, summaries and statistics of calving:</p>
<p>Statistics:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">part</span><span class="op">$</span><span class="va">statistics</span></span></code></pre></div>
<pre><code><span><span class="co">##         ID_Year      ID Year Best.Model   M0.AIC Mcalf.AIC    M0.mnll</span></span>
<span><span class="co">## 1   Dancer_2002  Dancer 2002       calf 2127.988  2049.150 -1061.9938</span></span>
<span><span class="co">## 2   Dancer_2003  Dancer 2003     nocalf 2343.712  2352.656 -1169.8561</span></span>
<span><span class="co">## 3   Dancer_2004  Dancer 2004     nocalf 2417.476        NA -1206.7378</span></span>
<span><span class="co">## 4  Prancer_2014 Prancer 2014     nocalf 2046.705  2063.563 -1021.3523</span></span>
<span><span class="co">## 5  Prancer_2015 Prancer 2015       calf 1999.761  1986.886  -997.8806</span></span>
<span><span class="co">## 6  Prancer_2016 Prancer 2016       calf 1999.598  1989.871  -997.7991</span></span>
<span><span class="co">## 7    Vixen_2007   Vixen 2007       calf 2141.104  2083.512 -1068.5520</span></span>
<span><span class="co">## 8    Vixen_2008   Vixen 2008       calf 2140.372  2113.974 -1068.1862</span></span>
<span><span class="co">## 9    Vixen_2009   Vixen 2009       calf 2129.976  2092.720 -1062.9879</span></span>
<span><span class="co">## 10   Comet_2006   Comet 2006       calf 2262.255  2242.464 -1129.1276</span></span>
<span><span class="co">## 11   Comet_2007   Comet 2007       calf 2068.392  2054.771 -1032.1958</span></span>
<span><span class="co">##    Mcalf.mnll</span></span>
<span><span class="co">## 1  -1019.5752</span></span>
<span><span class="co">## 2  -1171.3280</span></span>
<span><span class="co">## 3          NA</span></span>
<span><span class="co">## 4  -1026.7816</span></span>
<span><span class="co">## 5   -988.4432</span></span>
<span><span class="co">## 6   -989.9354</span></span>
<span><span class="co">## 7  -1036.7559</span></span>
<span><span class="co">## 8  -1051.9869</span></span>
<span><span class="co">## 9  -1041.3602</span></span>
<span><span class="co">## 10 -1116.2321</span></span>
<span><span class="co">## 11 -1022.3857</span></span></code></pre>
<p>Estimated parameters:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">part</span><span class="op">$</span><span class="va">par</span></span></code></pre></div>
<pre><code><span><span class="co">##         ID Year   alpha.0      beta.0 alpha.mean1  beta.mean1 alpha.calf1</span></span>
<span><span class="co">## 1   Dancer 2002 1.8157222 0.003385664    4.110104 0.004935978           1</span></span>
<span><span class="co">## 2   Dancer 2003 1.5163935 0.002816200    1.173065 0.002569369           1</span></span>
<span><span class="co">## 3   Dancer 2004 0.8864629 0.001476667          NA          NA          NA</span></span>
<span><span class="co">## 4  Prancer 2014 1.8134460 0.004275352    2.163503 0.005348627           1</span></span>
<span><span class="co">## 5  Prancer 2015 1.7909516 0.005022935    1.971807 0.005734049           1</span></span>
<span><span class="co">## 6  Prancer 2016 1.4451783 0.003647874    1.381339 0.002648580           1</span></span>
<span><span class="co">## 7    Vixen 2007 1.3421362 0.002334021    2.957727 0.002822821           1</span></span>
<span><span class="co">## 8    Vixen 2008 1.5909909 0.003059685    1.281277 0.002284303           1</span></span>
<span><span class="co">## 9    Vixen 2009 0.7521360 0.001306296    1.191237 0.001197908           1</span></span>
<span><span class="co">## 10   Comet 2006 1.4344893 0.003243705    1.846232 0.004439056           1</span></span>
<span><span class="co">## 11   Comet 2007 1.1338237 0.002390424    1.068144 0.001992606           1</span></span>
<span><span class="co">##     beta.calf1 BP.calf1       calving.date1 recovery1</span></span>
<span><span class="co">## 1  0.014659220       13 2002-06-01 00:00:00  504.0000</span></span>
<span><span class="co">## 2  0.005138737      389 2003-06-12 00:00:00  120.0000</span></span>
<span><span class="co">## 3           NA       NA                &lt;NA&gt;        NA</span></span>
<span><span class="co">## 4  0.010697254        8 2014-05-27 00:00:00  312.0007</span></span>
<span><span class="co">## 5  0.011468098      384 2015-06-07 00:01:00  247.9643</span></span>
<span><span class="co">## 6  0.009014247      748 2016-06-05 00:01:00  260.7497</span></span>
<span><span class="co">## 7  0.012157285       12 2007-05-31 00:00:00  504.0000</span></span>
<span><span class="co">## 8  0.013520722      389 2008-06-11 00:00:00  120.0000</span></span>
<span><span class="co">## 9  0.006606989      748 2009-06-05 00:01:00  504.0000</span></span>
<span><span class="co">## 10 0.008878112       16 2006-06-04 00:01:00  296.0004</span></span>
<span><span class="co">## 11 0.012815665      389 2007-06-12 00:00:00  120.0000</span></span></code></pre>
<p>Summary of results:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">part</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<pre><code><span><span class="co">##         ID Year Best.Model        calving.date Recovery calf.loc.x calf.loc.y</span></span>
<span><span class="co">## 1   Dancer 2002       calf 2002-06-01 00:00:00       21   217352.1    7305597</span></span>
<span><span class="co">## 2   Dancer 2003     nocalf                &lt;NA&gt;       NA         NA         NA</span></span>
<span><span class="co">## 3   Dancer 2004     nocalf                &lt;NA&gt;       NA         NA         NA</span></span>
<span><span class="co">## 4  Prancer 2014     nocalf                &lt;NA&gt;       NA         NA         NA</span></span>
<span><span class="co">## 5  Prancer 2015       calf 2015-06-07 00:01:00       10   206193.7    7321665</span></span>
<span><span class="co">## 6  Prancer 2016       calf 2016-06-05 00:01:00       11   230550.3    7320223</span></span>
<span><span class="co">## 7    Vixen 2007       calf 2007-05-31 00:00:00       21   221893.5    7313969</span></span>
<span><span class="co">## 8    Vixen 2008       calf 2008-06-11 00:00:00        5   240340.4    7283373</span></span>
<span><span class="co">## 9    Vixen 2009       calf 2009-06-05 00:01:00       21   209709.3    7320380</span></span>
<span><span class="co">## 10   Comet 2006       calf 2006-06-04 00:01:00       12   219053.9    7327185</span></span>
<span><span class="co">## 11   Comet 2007       calf 2007-06-12 00:00:00        5   245517.3    7342269</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="compact-r-code">Compact R code<a class="anchor" aria-label="anchor" href="#compact-r-code"></a>
</h3>
<p>In summary, the complete analysis can be forformed with the following
few lines of code:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">TuktuTools</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">caribou</span><span class="op">)</span></span>
<span><span class="va">caribou_prepped</span> <span class="op">&lt;-</span> <span class="va">caribou</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">removeOutliers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/prepData.html">prepData</a></span><span class="op">(</span>start <span class="op">=</span> <span class="st">"05-19"</span>, end <span class="op">=</span> <span class="st">"07-07"</span>, nfixes <span class="op">=</span> <span class="fl">1</span>, dayloss <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">getSpeed</span></span>
<span><span class="fu"><a href="../reference/estimateCalving.html">estimateCalving</a></span><span class="op">(</span><span class="va">caribou_prepped</span>, int<span class="op">=</span><span class="fl">3</span>, kcons<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">21</span><span class="op">)</span>, models <span class="op">=</span> <span class="st">"calfonly"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ophélie Couriot.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
