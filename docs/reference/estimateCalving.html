<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Parturition timing function — estimateCalving • TuktuTools</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Parturition timing function — estimateCalving"><meta property="og:description" content="Function that determine calving status of a female (i.e. no calf, with a calf, calf lost)
the calving date and the calf death date (if any).
This is an adaptation of the individual based method developed by Demars et al. (2013),
which has proven good reliability to estimate calving status and calving date for females
from the Western Arctic Herd in a previous study (Cameron et al. 2018).
However, we adapted this method to be able to infer parturition based on the 
female movement rate through time."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TuktuTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/estimating_parturition.html">Estimating caribou calving dates and locations using the TuktuTools Package</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Parturition timing function</h1>
    
    <div class="hidden name"><code>estimateCalving.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function that determine calving status of a female (i.e. no calf, with a calf, calf lost)
the calving date and the calf death date (if any).
This is an adaptation of the individual based method developed by Demars et al. (2013),
which has proven good reliability to estimate calving status and calving date for females
from the Western Arctic Herd in a previous study (Cameron et al. 2018).
However, we adapted this method to be able to infer parturition based on the 
female movement rate through time.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">estimateCalving</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">int</span>,</span>
<span>  <span class="va">kcons</span>,</span>
<span>  models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"calfonly"</span><span class="op">)</span>,</span>
<span>  drawplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  saveplot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>df</dt>
<dd><p>a dataframe containing the movement rate between subsequent 
relocation of individuals, as obtained using `getSpeed`.
See ?get.speed for more information on the Data requirements</p></dd>


<dt>int</dt>
<dd><p>integer value indicating the minimum number of days between
the beginning of the time series and the first BP (calf birth),
the last BP (calf death) and the end of the time series,
and between the two BPs.
The main reason for this constraint is that a minimum number of data points are required in
each section of the time-series to be able to estimate model parameters.
We recommended 9 relocations, thereby 3 days.</p></dd>


<dt>kcons</dt>
<dd><p>vector of the minimum and maximum time it takes the female to recover normal speed (in days)</p></dd>


<dt>models</dt>
<dd><p>either "full" to fit all three models (i.e., no calf, calf and calf death models), or 
"calfonly" to fit only the no calf and calf models.</p></dd>


<dt>drawplot</dt>
<dd><p>if TRUE, the function will draw a plot of the movement rate in function to the date
with the prediction line of the best model selected by AIC</p></dd>


<dt>saveplot</dt>
<dd><p>if TRUE, the plot of the best model will be</p></dd>


<dt>dir</dt>
<dd><p>the directory used to save the plot (e.g., "C://Users/Documents/")</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>returns list of 3 dataframes:
`statistics` containing the best model for each female, selected based on AIC, the AIC of the 3 models 
(i.e. no calf model, calf model and calf death model) and the negative likelihood 
of each model.
`Par` containing the estimated parameters of all the models (0: no calf, 1: calf, 2: calf death)
`results` containing the best model, for each female, based on AIC,
 the calving timing and location (if the calf model is the best model),
and the mortality timing and location of the calf (if the calf death is the best model).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>All models assume speed follows a Gamma distribution and differ in two parameters: shape
and scale, which correspond to \(mean(speed)^2 / var(speed)\)
and \(var(speed) / mean(speed)\), respectively.
The mean speed is thus equal to \(shape * scale\).</p><ul><li><p>For the model representing females that do not calve: the mean speed remains constant
through the entire calving period.</p></li>
<li><p>For the model representing females that had a calf who survived 4 weeks after birth:
the mean speed is constant before calving, then abruptly drops for calving, creating a break point.
After calving, the mean speed increases progressively following:
\( (shape.calving * (mean(shape) - shape.calving) / k * time) * (scale.calving * (mean(scale) - scale.calving) / k) * time)\)
where k is the time, defined in days, required for the calf to achieve adult movement rates.</p></li>
<li><p>For the model representing females losing calves: there is an abrupt change in the slope of
the post-calving increase, creating a second break point after which the mean speed immediately
recovers its pre-calving value.</p></li>
</ul><p>The models therefore differ in their number of parameters to estimate:
the no calf model has two – shape and scale;
the calf model has four – shape, scale, k and calving date;
and the calf death model has five – shape, scale, k, calving and calf death.
We discriminated among models using Akaike’s Information Criterion (AIC)
with the best model being the one with the lowest AIC value.</p>
<p>The visualization portion of this code is adapted directly from Matt Cameron and supplementary materials in Cameron et al. 2018.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>DeMars, C., M. Auger-Méthé, U. Schlägel, S. Boutin, (Published online) Inferring Parturition and Neonate Survival from Movement Patterns of Female Ungulates. Ecology and Evolution. DOI: 10.1002/ece3.785
Cameron, M.D., Joly, K., Breed, G.A., et al. (2018). Movement-based methods to infer parturition events in migratory ungulates. Canadian Journal of Zoology. 96:1187–1195. https://doi.org/10.1139/cjz-2017-0314</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">TuktuTools</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">caribou</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove potential outliers and keep only females</span></span></span>
<span class="r-in"><span><span class="va">caribou.cleaned</span> <span class="op">&lt;-</span> <span class="fu"><a href="removeOutliers.html">removeOutliers</a></span><span class="op">(</span><span class="va">caribou</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">outlier</span> <span class="op">==</span> <span class="st">"FALSE"</span> <span class="op">&amp;</span> <span class="va">sex</span> <span class="op">==</span> <span class="st">"f"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cleaning Step 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of 'outliers' detected: 4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># keep data during calving period (i.e., May 19 to July 7), no more than 3 consecutive days of missing data</span></span></span>
<span class="r-in"><span><span class="co"># and at least 1 fix per day</span></span></span>
<span class="r-in"><span><span class="va">caribou.prepped</span> <span class="op">&lt;-</span> <span class="fu"><a href="prepData.html">prepData</a></span><span class="op">(</span><span class="va">caribou.cleaned</span>, start <span class="op">=</span> <span class="st">"05-19"</span>, end <span class="op">=</span> <span class="st">"07-07"</span>, </span></span>
<span class="r-in"><span>                            nfixes <span class="op">=</span> <span class="fl">1</span>, dayloss <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Period clipped to 05-19 - 07-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of excluded individuals-years: 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get movement rate for the females</span></span></span>
<span class="r-in"><span><span class="va">caribou.mr</span> <span class="op">&lt;-</span> <span class="fu"><a href="getSpeed.html">getSpeed</a></span><span class="op">(</span><span class="va">caribou.prepped</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">caribou.mr</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       ID sex                Time Year       Lon      Lat        x       y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Dancer   f 2002-05-19 00:00:00 2002 -130.6295 64.86413 139075.4 7215110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Dancer   f 2002-05-19 08:00:00 2002 -130.6010 64.91193 141061.6 7220245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Dancer   f 2002-05-19 16:00:00 2002 -130.5404 65.03517 145551.0 7233559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 Dancer   f 2002-05-20 00:00:00 2002 -130.4893 65.12021 149065.5 7242700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 Dancer   f 2002-05-20 08:00:00 2002 -130.4349 65.17452 152319.3 7248417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Dancer   f 2002-05-20 16:00:00 2002 -130.3993 65.22834 154681.2 7254187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   outlier               z dt        sl dhours     speed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   FALSE 139075+7215110i NA        NA      0        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   FALSE 141062+7220245i  8  5505.728      8  688.2160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   FALSE 145551+7233559i  8 14050.469     16 1756.3086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   FALSE 149066+7242700i  8  9792.617     24 1224.0772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   FALSE 152319+7248417i  8  6578.743     32  822.3429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   FALSE 154681+7254187i  8  6234.093     40  779.2616</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate calving with the no calf and calf model</span></span></span>
<span class="r-in"><span><span class="va">parturitions</span> <span class="op">&lt;-</span> <span class="fu">estimateCalving</span><span class="op">(</span><span class="va">caribou.mr</span>, int<span class="op">=</span><span class="fl">3</span>, kcons <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">21</span><span class="op">)</span>, models <span class="op">=</span> <span class="st">"full"</span>, drawplot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Dancer_2002"</span>
<span class="r-plt img"><img src="estimateCalving-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Dancer_2003"</span>
<span class="r-plt img"><img src="estimateCalving-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Dancer_2004"</span>
<span class="r-plt img"><img src="estimateCalving-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prancer_2014"</span>
<span class="r-plt img"><img src="estimateCalving-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prancer_2015"</span>
<span class="r-plt img"><img src="estimateCalving-5.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Prancer_2016"</span>
<span class="r-plt img"><img src="estimateCalving-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Vixen_2007"</span>
<span class="r-plt img"><img src="estimateCalving-7.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Vixen_2008"</span>
<span class="r-plt img"><img src="estimateCalving-8.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Vixen_2009"</span>
<span class="r-plt img"><img src="estimateCalving-9.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Comet_2006"</span>
<span class="r-plt img"><img src="estimateCalving-10.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Comet_2007"</span>
<span class="r-plt img"><img src="estimateCalving-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">parturitions</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ID_Year      ID Year Best.Model   M0.AIC Mcalf.AIC Mcalfdeath.AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Dancer_2002  Dancer 2002       calf 2127.988  2049.150       2051.989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Dancer_2003  Dancer 2003     nocalf 2343.712  2352.656       2352.494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Dancer_2004  Dancer 2004     nocalf 2417.476        NA             NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  Prancer_2014 Prancer 2014     nocalf 2046.705  2063.563       2060.998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Prancer_2015 Prancer 2015       calf 1999.761  1986.886       1987.933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  Prancer_2016 Prancer 2016       calf 1999.598  1989.871       1991.510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Vixen_2007   Vixen 2007       calf 2141.104  2083.512       2086.792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    Vixen_2008   Vixen 2008  calfdeath 2140.372  2113.974       2113.804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    Vixen_2009   Vixen 2009       calf 2129.976  2092.720       2094.988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   Comet_2006   Comet 2006       calf 2262.255  2242.464       2243.088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   Comet_2007   Comet 2007  calfdeath 2068.392  2054.771       2031.548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       M0.mnll Mcalf.mnll Mcaldeath.mnll</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  -1061.9938 -1019.5752     -1019.9945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  -1169.8561 -1171.3280     -1170.2468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  -1206.7378         NA             NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  -1021.3523 -1026.7816     -1024.4989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   -997.8806  -988.4432      -987.9665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   -997.7991  -989.9354      -989.7550</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  -1068.5520 -1036.7559     -1037.3961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  -1068.1862 -1051.9869     -1050.9019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  -1062.9879 -1041.3602     -1041.4941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 -1129.1276 -1116.2321     -1115.5442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 -1032.1958 -1022.3857     -1009.7738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ID Year   alpha.0      beta.0 alpha.mean1  beta.mean1 alpha.calf1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Dancer 2002 1.8157222 0.003385664    4.110104 0.004935978           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Dancer 2003 1.5163935 0.002816200    1.173065 0.002569369           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Dancer 2004 0.8864629 0.001476667          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  Prancer 2014 1.8134460 0.004275352    2.163503 0.005348627           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Prancer 2015 1.7909516 0.005022935    1.971807 0.005734049           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  Prancer 2016 1.4451783 0.003647874    1.381339 0.002648580           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Vixen 2007 1.3421362 0.002334021    2.957727 0.002822821           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    Vixen 2008 1.5909909 0.003059685    1.281277 0.002284303           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    Vixen 2009 0.7521360 0.001306296    1.191237 0.001197908           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   Comet 2006 1.4344893 0.003243705    1.846232 0.004439056           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   Comet 2007 1.1338237 0.002390424    1.068144 0.001992606           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     beta.calf1 BP.calf1       calving.date1 recovery1 alpha.mean2  beta.mean2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.014659220       13 2002-06-01 00:00:00  504.0000    4.110104 0.004935978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.005138737      389 2003-06-12 00:00:00  120.0000    1.173065 0.002569369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           NA       NA                &lt;NA&gt;        NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.010697254        8 2014-05-27 00:00:00  312.0007    2.163503 0.005348627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.011468098      384 2015-06-07 00:01:00  247.9643    1.971807 0.005734049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.009014247      748 2016-06-05 00:01:00  260.7497    1.381339 0.002648580</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  0.012157285       12 2007-05-31 00:00:00  504.0000    2.957727 0.002822821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.013520722      389 2008-06-11 00:00:00  120.0000    1.281277 0.002284303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.006606989      748 2009-06-05 00:01:00  504.0000    1.191237 0.001197908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.008878112       16 2006-06-04 00:01:00  296.0004    1.846232 0.004439056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 0.012815665      389 2007-06-12 00:00:00  120.0000    1.068144 0.001992606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    alpha.calf2  beta.calf2 BP.calf2       calving.date2 BP.calfdeath2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            1 0.014574431       13 2002-06-01 00:00:00            33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            1 0.005401832      389 2003-06-12 00:00:00           392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           NA          NA       NA                &lt;NA&gt;            NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            1 0.010697254        8 2014-05-27 00:00:00            20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            1 0.011468098      384 2015-06-07 00:01:00           391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6            1 0.009993710      748 2016-06-05 00:01:00           757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7            1 0.012045722       12 2007-05-31 00:00:00            32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8            1 0.019880896      389 2008-06-11 00:00:00           392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9            1 0.006585084      748 2009-06-05 00:01:00           768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10           1 0.008878112       16 2006-06-04 00:01:00            26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11           1 0.060760574      389 2007-06-12 00:00:00           392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        calfdeath.date2 recovery2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2002-06-21 00:00:00  504.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2003-06-15 00:00:00  120.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                 &lt;NA&gt;        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2014-06-08 00:00:00  475.1712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2015-06-14 00:00:00  315.1904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2016-06-14 00:00:00  231.0376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2007-06-20 00:00:00  504.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2008-06-14 00:00:00  120.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2009-06-25 00:00:00  504.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2006-06-14 00:01:00  408.5460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2007-06-15 00:01:00  311.9747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $results</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         ID Year Best.Model        calving.date           mort.date Recovery</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Dancer 2002       calf 2002-06-01 00:00:00                &lt;NA&gt;       21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Dancer 2003     nocalf                &lt;NA&gt;                &lt;NA&gt;       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   Dancer 2004     nocalf                &lt;NA&gt;                &lt;NA&gt;       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  Prancer 2014     nocalf                &lt;NA&gt;                &lt;NA&gt;       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  Prancer 2015       calf 2015-06-07 00:01:00                &lt;NA&gt;       10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  Prancer 2016       calf 2016-06-05 00:01:00                &lt;NA&gt;       11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    Vixen 2007       calf 2007-05-31 00:00:00                &lt;NA&gt;       21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    Vixen 2008  calfdeath 2008-06-11 00:00:00 2008-06-14 00:00:00       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    Vixen 2009       calf 2009-06-05 00:01:00                &lt;NA&gt;       21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   Comet 2006       calf 2006-06-04 00:01:00                &lt;NA&gt;       12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   Comet 2007  calfdeath 2007-06-12 00:00:00 2007-06-15 00:01:00       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    calf.loc.x calf.loc.y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    217352.1    7305597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    206193.7    7321665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    230550.3    7320223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    221893.5    7313969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    240340.4    7283373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    209709.3    7320380</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   219053.9    7327185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   245517.3    7342269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get plot for one individual</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">caribou.mr</span><span class="op">$</span><span class="va">ID</span>, <span class="va">caribou.mr</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span> <span class="co"># take Vixen in 2008</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           2002 2003 2004 2006 2007 2008 2009 2014 2015 2016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Dancer   147  161  163    0    0    0    0    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Prancer    0    0    0    0    0    0    0  147  147  144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Vixen      0    0    0    0  147  147  144    0    0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Comet      0    0    0  161  144    0    0    0    0    0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># what is the identified model for Vixen in 2008?</span></span></span>
<span class="r-in"><span><span class="va">parturitions</span><span class="op">$</span><span class="va">results</span><span class="op">[</span><span class="va">parturitions</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="st">"Vixen"</span> <span class="op">&amp;</span> </span></span>
<span class="r-in"><span>                       <span class="va">parturitions</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">Year</span> <span class="op">==</span> <span class="fl">2008</span>,<span class="op">]</span> <span class="co"># "calfdeath"</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      ID Year Best.Model calving.date  mort.date Recovery calf.loc.x calf.loc.y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 Vixen 2008  calfdeath   2008-06-11 2008-06-14       NA   240340.4    7283373</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plotCalvingRange</span><span class="op">(</span>df <span class="op">=</span> <span class="va">caribou.mr</span><span class="op">[</span><span class="va">caribou.mr</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="st">"Vixen"</span> <span class="op">&amp;</span> </span></span>
<span class="r-in"><span>                                   <span class="va">caribou.mr</span><span class="op">$</span><span class="va">Year</span> <span class="op">==</span> <span class="fl">2008</span>,<span class="op">]</span>, int <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>               kcons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">21</span><span class="op">)</span>, bestmodel <span class="op">=</span> <span class="st">"calfdeath"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in plotCalvingRange(df = caribou.mr[caribou.mr$ID == "Vixen" &amp; caribou.mr$Year ==     2008, ], int = 3, kcons = c(5, 21), bestmodel = "calfdeath"):</span> could not find function "plotCalvingRange"</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ophélie Couriot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

